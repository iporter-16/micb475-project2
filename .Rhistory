heat_smok <- pathway_heatmap(abundance = abundance_data_smoking[,-1] %>% filter(pathway %in% feature_with_p_0.05_smok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
abundance_data_smoking <- rearrange(abundance_data_smoking,pathway)
abundance_data_smoking <- relocate(abundance_data_smoking,pathway)
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- relocate(abundance_data_smoking,pathway)
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data)
abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking[,-1] %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
view(daa_results_df)
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
# abundance_data_smoking <- relocate(abundance_data_smoking,pathway)
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data)
# abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
view(daa_results_df)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking[,-1] %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
abundance_data_smoking <- relocate(abundance_data_smoking,pathway)
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data)
abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking[,-1] %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
# abundance_data_smoking <- relocate(abundance_data_smoking,pathway)
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data)
abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
view(feature_with_p_0.05_nonsmok)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking[,-1] %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
# abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
view(feature_with_p_0.05_nonsmok)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
heat_nonsmok
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data)
abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
view(feature_with_p_0.05_nonsmok)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
heat_nonsmok
abundance_data_nonsmoking[1]
view(abundance_data_nonsmoking)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- relocate(abundance_data_nonsmoking,pathway)
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
view(feature_with_p_0.05_nonsmok)
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
rownames(abundance_data_nonsmoking) = abundance_data$pathway
view(abundance_data_nonsmoking)
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
view(daa_results_df_nonsmoking)
view(feature_with_p_0.05_nonsmok)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
view(feature_with_p_0.05_nonsmok)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
rownames(abundance_data_nonsmoking) = abundance_data$pathway
View(abundance_data_nonsmoking)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
View(daa_results_df_nonsmoking)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_nonsmoking_df %>% filter(p_values < 0.05)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
View(feature_with_p_0.05_nonsmok)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
# rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = rownames(abundance_data_smoking)
rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data_nonsmoking)
rownames(abundance_data_nonsmoking) = NULL
# abundance_data_smoking <- cbind(abundance_data$pathway,select(abundance_data, metadata_smoking$`#SampleID`))
# abundance_data_nonsmoking <- cbind(abundance_data$pathway,select(abundance_data, metadata_nonsmoking$`#SampleID`))
# names(abundance_data_smoking)[names(abundance_data_smoking) == 'abundance_data$pathway'] <- 'pathway'
# names(abundance_data_nonsmoking)[names(abundance_data_nonsmoking) == 'abundance_data$pathway'] <- 'pathway'
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-384], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
### ISSUE: there is no column called pathway, because we removed it at line 15.
### Removing it appears to subsequently make pathway_daa() fail, but then it's needed here?
feature_with_p_0.05 <- daa_results_df_smoking %>% filter(p_values < 0.05)
pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.1$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
feature_with_p_0.05 <- daa_results_df_smoking %>% filter(p_values < 0.05)
pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
rownames(abundance_data_nonsmoking) = abundance_data$pathway
# rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmaps for smoking and nonsmoking populations
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature)
%>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
view(feature_with_p_0.05_nonsmok)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = rownames(abundance_data_smoking)
rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data_nonsmoking)
rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-384], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
view(feature_with_p_0.05_smok)
#From picrust2 analysis, produces heatmaps of pathways signififantly (p<0.05 up or downregulated)
#in smoking and nonsmoking adults, displaying their fiber consumption (high or low)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = rownames(abundance_data_smoking)
rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data_nonsmoking)
rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-384], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
heat_nonsmok
#### Nov 1, 2023 - SKA ####
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
abundance_file <- "picrust processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv.gz"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv.gz"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
rownames(abundance_data) = abundance_data$pathway
abundance_data = abundance_data[,-1]
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
# load metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
results_file_input <- ggpicrust2(file = abundance_data,
metadata = metadata,
group = "smoker",
pathway = "MetaCyc",
daa_method = "LinDA",
ko_to_kegg = FALSE,
order = "pathway_class",
p_values_bar = TRUE,
x_lab = "pathway_name")
abundance_data <- as.data.frame(abundance_data)
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
rownames(abundance_data) = abundance_data$pathway
abundance_data = abundance_data[,-1]
# load metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
results_file_input <- ggpicrust2(file = abundance_data,
metadata = metadata,
group = "smoker",
pathway = "MetaCyc",
daa_method = "LinDA",
ko_to_kegg = FALSE,
order = "pathway_class",
p_values_bar = TRUE,
x_lab = "pathway_name")
results_file_input <- ggpicrust2(file = abundance_file,
metadata = metadata,
group = "smoker",
pathway = "MetaCyc",
daa_method = "LinDA",
ko_to_kegg = FALSE,
order = "pathway_class",
p_values_bar = TRUE,
x_lab = "pathway_name")
kegg_abundance <- ko2kegg_abundance("picrust_processing/picrust2_output_pipeline/KO_metagenome_out/pred_metagenome_unstrat.tsv")
kegg_abundance <- ko2kegg_abundance("picrust_processing/picrust2_out_pipeline/KO_metagenome_out/pred_metagenome_unstrat.tsv")
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
# Please change group to "your_group_column" if you are not using example dataset
daa_results_df <- pathway_daa(abundance = abundance_data, metadata = metadata, group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
View(feature_with_p_0.05)
View(feature_with_p_0.05_nonsmok)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
View(feature_with_p_0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
#### Nov 1, 2023 - SKA ####
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
# load abundance
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv.gz"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
rownames(abundance_data) = abundance_data$pathway
abundance_data = abundance_data[,-1]
# load metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
results_file_input <- ggpicrust2(file = abundance_file,
metadata = metadata,
group = "smoker",
pathway = "MetaCyc",
daa_method = "LinDA",
ko_to_kegg = FALSE,
order = "pathway_class",
p_values_bar = TRUE,
x_lab = "pathway_name")
kegg_abundance <- ko2kegg_abundance("picrust_processing/picrust2_out_pipeline/KO_metagenome_out/pred_metagenome_unstrat.tsv")
abundance_data$pathway = rownames(abundance_data)
abundance data
abunda
# load abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv.gz"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_data$pathway = rownames(abundance_data)
abundance_data = abundance_data[,-1]
# load metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
daa_results_df <- pathway_daa(abundance = abundance_data,
metadata = metadata,
group = "smoker",
daa_method = "LinDA",
select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
daa_results_df <- pathway_daa(abundance = abundance_data[,-1],
metadata = metadata,
group = "smoker",
daa_method = "LinDA",
select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_adjust < 0.05)
View(feature_with_p_0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
View(daa_results_df)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_values < 0.05)
###################################################
# not getting features with p<0.05
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
View(feature_with_p_0.05)
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
daa_results_df <- pathway_daa(abundance = abundance_data,
metadata = metadata,
group = "smoker",
daa_method = "LinDA",
select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_values < 0.05)
###################################################
# not getting features with p<0.05
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
rlang::last_trace()
View(feature_with_p_0.05)
feature_with_p_0.05$pathway = rownames(feature_with_p_0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
#### Nov 1, 2023 - SKA ####
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
# load abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv.gz"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_data$pathway = rownames(abundance_data)
abundance_data = abundance_data[,-1]
# load metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE)
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
daa_results_df <- pathway_daa(abundance = abundance_data,
metadata = metadata,
group = "smoker",
daa_method = "LinDA",
select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_values < 0.05)
feature_with_p_0.05$pathway = rownames(feature_with_p_0.05)
# Perform pathway differential abundance analysis (DAA) using ALDEx2 method
daa_results_df <- pathway_daa(abundance = abundance_data,
metadata = metadata,
group = "smoker",
daa_method = "LinDA",
select = NULL, reference = NULL)
# Generate pathway heatmap
# Please change column_to_rownames() to the feature column if you are not using example dataset
# Please change group to "your_group_column" if you are not using example dataset
feature_with_p_0.05 <- daa_results_df %>% filter(p_values < 0.05)
feature_with_p_0.05$pathway = rownames(feature_with_p_0.05)
pathway_heatmap(abundance = abundance_data %>% filter(pathway %in% feature_with_p_0.05$feature) %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
View(abundance_data)
View(feature_with_p_0.05_nonsmok)
View(abundance_data)
