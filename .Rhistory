# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-384], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
library(ggh4x)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
heat_smok
View(abundance_data)
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "fiber_category", daa_method = "LinDA", select = NULL, reference = NULL)
metadata
metadata
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = rownames(abundance_data_smoking)
rownames(abundance_data_smoking) = NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = rownames(abundance_data_nonsmoking)
rownames(abundance_data_nonsmoking) = NULL
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "fiber_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Perform pathway differential abundance analysis (DAA) using LinDA
# This requires
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
View(abundance_data)
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")
View(daa_results_df)
View(feature_with_p_0.05_smok)
View(feature_with_p_0.05_nonsmok)
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
View(feature_with_p_0.05_smok)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category") + ggtitle("x")
heat_nonsmok
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")+ ggtitle("Significant differential expression in smokers")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category") + ggtitle("Significant differential expression in nonsmokers")
heat_smok
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-1], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")+ ggtitle("Significant differential expression in smokers")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category") + ggtitle("Significant differential expression in nonsmokers")
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
View(abundance_data_smoking)
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking, metadata = metadata_smoking, group = "fibre_category")
heat_nonsmok
heat_smok
### LDL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
View(abundance_data_smoking)
View(metadata)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
### LDL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
View(metadata)
View(metadata_smoking)
unique(metadata_smoking$LDL_category)
abundance_data_smoking[,-1]
### LDL
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = na.omit(metadata_smoking),
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
metadata_smoking
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
#From picrust2 analysis, produces heatmaps of pathways signififantly (p<0.05 up or downregulated)
#in smoking and nonsmoking adults, displaying their fiber consumption (high or low)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = rownames(abundance_data_smoking)
View(abundance_data_smoking)
abundance_data_smoking$pathway = rownames(abundance_data)
View(abundance_data_smoking)
View(abundance_data)
abundance_data_smoking$pathway = abundance_data$pathway
View(abundance_data_smoking)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-1], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-59], metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
View(abundance_data)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking[,-59], metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking[,-383], metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")+ ggtitle("Significant differential expression in smokers")
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")+ ggtitle("Significant differential expression in smokers")
View(feature_with_p_0.05_nonsmok)
feature_with_p_0.05_smok
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
View(feature_with_p_0.05_smok)
View(daa_results_df)
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data[,-1]%>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data%>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
View(abundance_data_nonsmoking)
abundance_data_nonsmoking$pathway = abundance_data$pathway
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category")+ ggtitle("Significant differential expression in smokers")
heat_smok
View(daa_results_df_smoking)
View(abundance_data_nonsmoking)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_categor", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") + ggtitle("Significant differential expression in nonsmokers")
heat_nonsmok
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category")+ ggtitle("Significant differential expression in smokers \n with high/low LDL")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") + ggtitle("Significant differential expression in nonsmokers \n with high/low LDL")
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in smokers \n with high/low LDL")
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in nonsmokers \n with high/low LDL")
heat_nonsmok
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking, metadata = metadata_smoking, group = "fibre_category")
heat_smok
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
View(abundance_data_smoking)
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "fibre_category")
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
View(daa_results_df_smoking)
#Run PCA plots
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "smoker")
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "fibre_category")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
View(abundance_data)
View(abundance_data_nonsmoking)
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
View(metadata_nonsmoking)
unique(metadata_nonsmoking$LDL_category)
unique(metadata_nonsmoking$fibre_category)
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "smoker")
abundance_data_nonsmoking <- select(pathway, everything())
abundance_data_nonsmoking$pathway
abundance_data_nonsmoking <- select(abundance_data_nonsmoking$pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
View(abundance_data_nonsmoking)
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "LDL_category")
View(abundance_data_nonsmoking %>% column_to_rownames("pathway"))
View(metadata_nonsmoking)
for (n in col(metadata)){return sd(metadata$n)}
for (n in col(metadata)){return(sd(metadata$n))}
sapply(abundance_data_nonsmoking[colnames(abundance_data_nonsmoking)], sd)
test <- sapply(abundance_data_nonsmoking[colnames(abundance_data_nonsmoking)], sd)
View(test)
View(abundance_data)
View(abundance_data_nonsmoking %>% column_to_rownames("pathway"))
View(abundance_data %>% column_to_rownames("pathway"))
View(abundance_data_nonsmoking)
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
### LDL ###
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking_LDL <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking_LDL <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap for LDL groups
feature_with_p_0.05_smok_LDL <- daa_results_df_smoking_LDL %>% filter(p_values < 0.05)
heat_smok_LDL <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in smokers with high/low LDL")
feature_with_p_0.05_nonsmok_LDL <- daa_results_df_nonsmoking_LDL %>% filter(p_values < 0.05)
heat_nonsmok_LDL <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in nonsmokers with high/low LDL")
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
#From picrust2 analysis, produces heatmaps of pathways signififantly (p<0.05 up or downregulated)
#in smoking and nonsmoking adults, displaying their fiber consumption (high or low)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap
feature_with_p_0.05_smok <- daa_results_df_smoking %>% filter(p_values < 0.05)
heat_smok <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category") +
ggtitle("Significant differential expression in smokers")
feature_with_p_0.05_nonsmok <- daa_results_df_nonsmoking %>% filter(p_values < 0.05)
heat_nonsmok <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "fibre_category") +
ggtitle("Significant differential expression in nonsmokers")
### LDL ###
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_smoking_LDL <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking_LDL <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
# Generate pathway heatmap for LDL groups
feature_with_p_0.05_smok_LDL <- daa_results_df_smoking_LDL %>% filter(p_values < 0.05)
heat_smok_LDL <- pathway_heatmap(abundance = abundance_data_smoking %>% filter(pathway %in% feature_with_p_0.05_smok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in smokers with high/low LDL")
feature_with_p_0.05_nonsmok_LDL <- daa_results_df_nonsmoking_LDL %>% filter(p_values < 0.05)
heat_nonsmok_LDL <- pathway_heatmap(abundance = abundance_data_nonsmoking %>% filter(pathway %in% feature_with_p_0.05_nonsmok$feature) %>%
column_to_rownames("pathway"), metadata = metadata, group = "LDL_category") +
ggtitle("Significant differential expression in nonsmokers with high/low LDL")
?jpeg
ggsave("../heatmaps/heatmap_smok_fibre.png",heat_smok)
pwd()
getwd()
ggsave("/heatmaps/heatmap_smok_fibre.png",heat_smok)
ggsave("heatmap_smok_fibre.png",heat_smok,path="/heatmaps")
ggsave("heatmap_smok_fibre.png",heat_smok)
setwd("/Users/porte16049/Desktop/MICB475/micb475-project2/heatmaps")
ggsave("heatmap_smok_fibre.png",heat_smok)
ggsave("heatmap_nonsmok_fibre.png",heat_nonsmok)
ggsave("heatmap_nonsmok_LDL.png",heat_nonsmok_LDL)
ggsave("heatmap_smok_LDL.png",heat_smok_LDL)
ggsave("heatmap_smok_LDL.png",heat_smok_LDL,scale=2)
ggsave("heatmap_nonsmok_LDL.png",heat_nonsmok_LDL,scale=2)
ggsave("heatmap_nonsmok.png",heat_nonsmok,scale=2)
ggsave("heatmap_smok.png",heat_smok,scale=2)
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
View(abundance_data)
View(abundance_data_smoking)
sd(abundance_data_nonsmoking$SRR6267450)
sd(abundance_data_nonsmoking$SRR6267610)
sds <- apply(abundance_data_nonsmoking, 384, sd)
sds <- apply(abundance_data_nonsmoking, 383, sd)
sds <- apply(abundance_data_nonsmoking, 2, sd)
sds
?apply
sds <- apply(abundance_data_nonsmoking, c(1,2), sd)
warnings()
sds <- apply(abundance_data_nonsmoking, 2, sd)
view(sds)
sds <- apply(abundance_data_nonsmoking %>% column_to_rownames("pathway"), 2, sd)
View(sds)
view(sds)
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata, group = "LDL_category")
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
abundance_data_smoking <- abundance_data_smoking[order(row.names(abundance_data_smoking)),]
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
View(abundance_data_smoking)
row.names(abundance_data_smoking) <- NA
row.names(abundance_data_smoking) <- NULL
pathway_pca(abundance = abundance_data_smoking %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
View(abundance_data_smoking)
sds <- apply(abundance_data_smoking, 2, sd)
view(sds)
sds <- apply(abundance_data_smoking%>% column_to_rownames("pathway"), 2, sd)
view(sds)
pathway_pca(abundance = (abundance_data_smoking %>% column_to_rownames("pathway")), metadata = metadata_smoking, group = "LDL_category")
sds <- apply(abundance_data_smoking%>% column_to_rownames("pathway"), 1, sd)
view(sds)
row_sds <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %?% apply(1, sd)
row_sds <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd)
filtered <- abundance_data_nonsmoking[row_sds != 0, ]
pathway_pca(abundance = abundance_data_nonsmoking, metadata = metadata_nonsmoking, group = "LDL_category")
View(abundance_data_nonsmoking)
pathway_pca(abundance = abundance_data_nonsmoking%>% column_to_rownames("pathway") , metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = filtered, metadata = metadata_nonsmoking, group = "LDL_category")
View(filtered)
pathway_pca(abundance = filtered%>% column_to_rownames("pathway") , metadata = metadata_nonsmoking, group = "LDL_category")
row.names(filtered) <- NULL
pathway_pca(abundance = filtered %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
filtered <- abundance_data_nonsmoking %>%
column_to_rownames("pathway") %>%
apply(1, sd) %>%
{abundance_data_nonsmoking[. != 0, ]}
pathway_pca(abundance = filtered %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
filtered <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd) %>%
{filtered_df <- abundance_data_nonsmoking[. != 0, ]; row.names(filtered_df) <- NULL; filtered_df}
pathway_pca(abundance = filtered %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
filtered <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd) %>% {abundance_data_nonsmoking[. != 0, ]}
row.names(filtered) <- NULL
pathway_pca(abundance = filtered %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
log(4)
log10(4)
log2(4)
log(4,4)
?row.names
filtered_LDL_smok <- abundance_data_smoking %>% column_to_rownames("pathway") %>% apply(1, sd) %>%
{abundance_data_smoking[. != 0, ]; row.names(filtered_LDL_smok) <- NULL; filtered_LDL_smok}
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
library
library
library
#From picrust2 analysis, produces heatmaps of pathways signififantly (p<0.05 up or downregulated)
#in smoking and nonsmoking adults, displaying their fiber consumption (high or low)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
setwd("/Users/porte16049/Desktop/MICB475/micb475-project2/")
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
row.names(abundance_data_smoking) <- NULL
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
filtered_LDL_nonsmok <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd) %>%
{abundance_data_nonsmoking[. != 0, ]; row.names(filtered_LDL_nonsmok) <- NULL; filtered_LDL_nonsmok}
filtered_LDL_smok <- abundance_data_smoking %>% column_to_rownames("pathway") %>% apply(1, sd) %>%
{abundance_data_smoking[. != 0, ]; row.names(filtered_LDL_smok) <- NULL; filtered_LDL_smok}
#Run PCA plots
pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
row_sds_nonsmok <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd)
filtered_LDL_nonsmok <- abundance_data_nonsmoking[row_sds_nonsmok != 0, ]
row.names(filtered_LDL_nonsmok) <- NULL
row_sds_smok <- abundance_data_smoking %>% column_to_rownames("pathway") %>% apply(1, sd)
filtered_LDL_smok <- abundance_data_smoking[row_sds_smok != 0, ]
row.names(filtered_LDL_smok) <- NULL
pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
pathway_pca(abundance = filtered_LDL_smok %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
PCA_total <- pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata, group = "smoker")
PCA_nonsmok_LDL <- pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking, group = "LDL_category")
PCA_smok_LDL <- pathway_pca(abundance = filtered_LDL_smok %>% column_to_rownames("pathway"), metadata = metadata_smoking, group = "LDL_category")
View(PCA_nonsmok_LDL)
PCA_total <- pathway_pca(abundance = abundance_data %>% column_to_rownames("pathway"),
metadata = metadata, group = "smoker")+ggtitle("PCA plot for all participants")
PCA_nonsmok_LDL <- pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"),
metadata = metadata_nonsmoking, group = "LDL_category")+ggtitle("PCA plot for nonsmokers")
PCA_smok_LDL <- pathway_pca(abundance = filtered_LDL_smok %>% column_to_rownames("pathway"),
metadata = metadata_smoking, group = "LDL_category")+ggtitle("PCA plot for smokers")
pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"),
metadata = metadata_nonsmoking, group = "LDL_category")+ggtitle("PCA plot for nonsmokers")
pathway_pca(abundance = filtered_LDL_nonsmok %>% column_to_rownames("pathway"),
metadata = metadata_nonsmoking, group = "LDL_category")+ggtitle("    PCA plot for nonsmokers")
ggsave("pca_nonsmokers_LDL.png",PCA_nonsmok_LDL,scale=1)
ggsave("pca_smokers_LDL.png",PCA_smok_LDL,scale=1)
?log
#Save plots. Only change wd to save plots!
setwd("/Users/porte16049/Desktop/MICB475/micb475-project2/pcoa_plots")
ggsave("pca_all_LDL.png",PCA_total,scale=1)
