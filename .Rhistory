if (unique_features[j] %in% (get(paste0("sig_", c("LinDA", "edgeR", "deseq")[i])))[,1]) {
table[j, i] <- 1}}}
library(reshape2)
binary_data <- melt(table, varnames = c("Feature", "Formula"))
binary_data$value <- as.factor(binary_data$value)  # Convert to factor
# Create a heatmap using ggplot2
ggplot(binary_data, aes(x = Formula, y = Feature, fill = value)) + geom_tile() +
scale_fill_manual(values = c("white", "black"), labels = c(0,1)) +
labs(x = "Dataframes", y = "Row Names", fill = "Presence") +
theme_minimal() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Differential expression: smokers vs. nonsmokers")
#!/bin/R
#PURPOSE: test different methods of differential expression analyses and compare top hits
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
getwd()
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
getwd()
#!/bin/R
#PURPOSE: test different methods of differential expression analyses and compare top hits
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
getwd()
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
getwd()
#!/bin/R
#PURPOSE: test different methods of differential expression analyses and compare top hits
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#read metadata
metadata <- read_delim("../colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#read metadata
metadata <- read_delim("../colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE,show_col_types = FALSE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
daa_results_df_LinDA <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_LinDA_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_LinDA_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_edgeR <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "edgeR", select = NULL, reference = NULL)
daa_results_df_edgeR_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "edgeR", select = NULL, reference = NULL)
daa_results_df_edgeR_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "edgeR", select = NULL, reference = NULL)
daa_results_df_deseq <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "DESeq2", select = NULL, reference = NULL)
daa_results_df_deseq_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "DESeq2", select = NULL, reference = NULL)
daa_results_df_deseq_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "DESeq2", select = NULL, reference = NULL)
results <- c(daa_results_df_LinDA,daa_results_df_edgeR,daa_results_df_deseq)
sig_LinDA <- daa_results_df_LinDA%>% filter(p_values < 0.05)
sig_edgeR <- daa_results_df_edgeR%>% filter(p_values < 0.05)
sig_deseq <- daa_results_df_deseq%>% filter(p_values < 0.05)
sig_results <- rbind(sig_LinDA,sig_edgeR,sig_deseq)
unique_features <- unique(sig_results$feature)
table <- matrix(data=0,nrow=length(unique_features),ncol=3)
rownames(table) <- unique_features
colnames(table) <- c("LinDA","edgeR","DESeq2")
for (i in 1:3) {
for (j in 1:length(unique_features)) {
if (unique_features[j] %in% (get(paste0("sig_", c("LinDA", "edgeR", "deseq")[i])))[,1]) {
table[j, i] <- 1}}}
library(reshape2)
binary_data <- melt(table, varnames = c("Feature", "Formula"))
binary_data$value <- as.factor(binary_data$value)  # Convert to factor
# Create a heatmap using ggplot2
ggplot(binary_data, aes(x = Formula, y = Feature, fill = value)) + geom_tile() +
scale_fill_manual(values = c("white", "black"), labels = c(0,1)) +
labs(x = "Method", y = "Pathway", fill = "Detection") +
theme_minimal() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Differential expression: smokers vs. nonsmokers")
results <- c(daa_results_df_LinDA,daa_results_df_edgeR,daa_results_df_deseq)
sig_LinDA <- daa_results_df_LinDA_nonsmoking%>% filter(p_values < 0.05)
sig_edgeR <- daa_results_df_edgeR_nonsmoking%>% filter(p_values < 0.05)
sig_deseq <- daa_results_df_deseq_nonsmoking%>% filter(p_values < 0.05)
sig_results <- rbind(sig_LinDA,sig_edgeR,sig_deseq)
unique_features <- unique(sig_results$feature)
table <- matrix(data=0,nrow=length(unique_features),ncol=3)
rownames(table) <- unique_features
colnames(table) <- c("LinDA","edgeR","DESeq2")
for (i in 1:3) {
for (j in 1:length(unique_features)) {
if (unique_features[j] %in% (get(paste0("sig_", c("LinDA", "edgeR", "deseq")[i])))[,1]) {
table[j, i] <- 1}}}
library(reshape2)
binary_data <- melt(table, varnames = c("Feature", "Formula"))
binary_data$value <- as.factor(binary_data$value)  # Convert to factor
# Create a heatmap using ggplot2
ggplot(binary_data, aes(x = Formula, y = Feature, fill = value)) + geom_tile() +
scale_fill_manual(values = c("white", "black"), labels = c(0,1)) +
labs(x = "Method", y = "Pathway", fill = "Detection") +
theme_minimal() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Differential expression: smokers vs. nonsmokers")
results <- c(daa_results_df_LinDA,daa_results_df_edgeR,daa_results_df_deseq)
sig_LinDA <- daa_results_df_LinDA_nonsmoking%>% filter(p_values < 0.05)
sig_edgeR <- daa_results_df_edgeR_nonsmoking%>% filter(p_values < 0.05)
sig_deseq <- daa_results_df_deseq_nonsmoking%>% filter(p_values < 0.05)
sig_results <- rbind(sig_LinDA,sig_edgeR,sig_deseq)
unique_features <- unique(sig_results$feature)
table <- matrix(data=0,nrow=length(unique_features),ncol=3)
rownames(table) <- unique_features
colnames(table) <- c("LinDA","edgeR","DESeq2")
for (i in 1:3) {
for (j in 1:length(unique_features)) {
if (unique_features[j] %in% (get(paste0("sig_", c("LinDA", "edgeR", "deseq")[i])))[,1]) {
table[j, i] <- 1}}}
library(reshape2)
binary_data <- melt(table, varnames = c("Feature", "Formula"))
binary_data$value <- as.factor(binary_data$value)  # Convert to factor
# Create a heatmap using ggplot2
ggplot(binary_data, aes(x = Formula, y = Feature, fill = value)) + geom_tile() +
scale_fill_manual(values = c("white", "black"), labels = c(0,1)) +
labs(x = "Method", y = "Pathway", fill = "Detection") +
theme_minimal() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Differential expression: smokers high vs. low LDL")
#AW
# Differential expression analysis (DESeq, edgeR), 2023-11-07
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read abundance data
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
#read metadata
metadata <- read_delim("../colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE,show_col_types = FALSE)
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read abundance and metadata
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
daa_results_df_LinDA <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_LinDA_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_LinDA_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "LDL_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_edgeR <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "edgeR", select = NULL, reference = NULL)
#2023-11-07 AW attempt at differential expression analysis (DESeq, edgeR)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ALDEx2)
library(edgeR)
pkgs <- c("phyloseq", "ALDEx2", "SummarizedExperiment", "Biobase", "devtools",
"ComplexHeatmap", "BiocGenerics", "BiocManager", "metagenomeSeq",
"Maaslin2", "edgeR", "lefser", "limma", "KEGGREST", "DESeq2")
for (pkg in pkgs) {
if (!requireNamespace(pkg, quietly = TRUE))
BiocManager::install(pkg)
}
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
### Isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
View(metadata_smoking)
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
library(ALDEx2)
library(DESeq2)
#read abundance and metadata
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
View(metadata_nonsmoking)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
#rownames(abundance_data) = abundance_data$pathway
#abundance_data = abundance_data[,-1]
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
#rownames(abundance_data) = abundance_data$pathway
#abundance_data = abundance_data[,-1]
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("../colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE,show_col_types = FALSE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking <- select(abundance_data, metadata_smoking$"#SampleID")
abundance_data_smoking <- select(abundance_data, metadata_smoking$SampleID)
abundance_data_smoking <- select(abundance_data, metadata_smoking$'SampleID')
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
library(dplyr)
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking <- select(abundance_data, `#SampleID`)
install.packages(c("fansi", "fBasics", "htmltools", "lme4", "Matrix", "matrixStats", "plyr", "RCurl", "Rfast", "rlang", "utf8", "vctrs", "xfun"))
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
#rownames(abundance_data) = abundance_data$pathway
#abundance_data = abundance_data[,-1]
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway <- abundance_data$pathway
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
library(ALDEx2)
library(DESeq2)
library(dplyr)
#read abundance and metadata
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
### Isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
#rownames(abundance_data) = abundance_data$pathway
#abundance_data = abundance_data[,-1]
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
#rownames(abundance_data) = abundance_data$pathway
#abundance_data = abundance_data[,-1]
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
View(metadata)
View(metadata_smoking)
metadata_smoking
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
View(metadata_smoking)
View(abundance_data)
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#select smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE,show_col_types = FALSE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
View(metadata_smoking)
library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library("ggh4x")
library(ALDEx2)
library(DESeq2)
library(dplyr)
#read abundance and metadata
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
metadata <- read_delim(
"colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
#Isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
