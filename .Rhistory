library(readr)
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library()
abundance_file <- "picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE)
abundance_data  =as.data.frame(abundance_data)
rownames(abundance_data) = abundance_data$pathway
abundance_data = abundance_data[,-1]
metadata <- read_delim(
"~/Desktop/MICB475/micb475-project2/colombia/metadata_categorized_CL.txt",
delim = "\t",
escape_double = FALSE,
trim_ws = TRUE
)
samples = colnames()
samples = colnames(metadata)
rm samples
rm(samples)
kegg_abundance <- ko2kegg_abundance("picrust2_out_pipeline/KO_metagenome_out/pred_metagenome_unstrat.tsv")
library(ggpicrust2)
library(tibble)
library(tidyverse)
library(ggprism)
library(patchwork)
library(ggh4x)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
setwd("/Users/porte16049/Desktop/MICB475/micb475-project2/")
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
#Filter data to remove 0 standard deviation
row_sds_nonsmok <- abundance_data_nonsmoking %>% column_to_rownames("pathway") %>% apply(1, sd)
filtered_LDL_nonsmok <- abundance_data_nonsmoking[row_sds_nonsmok != 0, ]
row.names(filtered_LDL_nonsmok) <- NULL
row_sds_smok <- abundance_data_smoking %>% column_to_rownames("pathway") %>% apply(1, sd)
filtered_LDL_smok <- abundance_data_smoking[row_sds_smok != 0, ]
row.names(filtered_LDL_smok) <- NULL
#Pulling the interesting unexpressed stuff
interesting_nonsmok <- abundance_data_nonsmoking[row_sds_nonsmok = 0, ]
#Pulling the interesting unexpressed stuff
interesting_nonsmok <- abundance_data_nonsmoking[row_sds_nonsmok== 0, ]
interesting_smok <- abundance_data_smoking[row_sds_smok== 0, ]
View(interesting_smok)
View(interesting_nonsmok)
interesting_nonsmok$pathway
interesting_smok$pathway
as.listinteresting_smok$pathway()
as.list(interesting_smok$pathway)
as.character(interesting_smok$pathway)
as.character(interesting_smok$pathway)
paste(interesting_smok$pathway)
paste(interesting_smok$pathway,sep=" ")
paste(interesting_smok$pathway,collapse=",")
all_interesting <- cbind(abundance_data_nonsmoking$pathway,abundance_data_smoking$pathway)
View(all_interesting)
all_interesting <- cbind(interesting_nonsmok$pathway,interesting_smok$pathway)
all_interesting <- c(interesting_nonsmok$pathway,interesting_smok$pathway)
all_interesting <- rbind(interesting_nonsmok$pathway,interesting_smok$pathway)
rm(all_interesting)
all_interesting <- rbind(interesting_nonsmok$pathway,interesting_smok$pathway)
View(all_interesting)
rm(all_interesting)
all_interesting <- interesting_nonsmok$pathway+interesting_smok$pathway
?cat
all_interesting <- cat(interesting_nonsmok$pathway+interesting_smok$pathway)
all_interesting <- cat(interesting_nonsmok$pathway,interesting_smok$pathway)
all_interesting <- as.data.frame(all_interesting)
?data.frame
all_interesting <- data.frame(interesting_nonsmok$pathway,interesting_smok$pathway)
View(all_interesting)
all_interesting <- data.frame(c(interesting_nonsmok$pathway,interesting_smok$pathway))
View(all_interesting)
all_interesting <- data.frame(c(interesting_nonsmok$pathway,interesting_smok$pathway),c("interesting","function"))
all_interesting <- data.frame(c(interesting_nonsmok$pathway,interesting_smok$pathway),c("interesting"))
View(all_interesting)
all_interesting <- data.frame(c(interesting_nonsmok$pathway,interesting_smok$pathway),)
all_interesting <- data.frame(pathway=c(interesting_nonsmok$pathway,interesting_smok$pathway))
View(all_interesting)
View(abundance_data)
#read abundance data
abundance_file <- "picrust_processing/picrust2_out_pipeline/pathways_out/path_abun_unstrat.tsv"
abundance_data <- read_delim(abundance_file, delim = "\t", col_names = TRUE, trim_ws = TRUE) %>% as.data.frame()
#read metadata
metadata <- read_delim("colombia/metadata_categorized_CL.txt",delim = "\t",escape_double = FALSE,trim_ws = TRUE)
#isolate smoking and nonsmoking from abundance data and metadata
metadata_smoking <- filter(metadata, metadata$smoker=="Yes")
metadata_nonsmoking <- filter(metadata, metadata$smoker=="No")
abundance_data_smoking <- select(abundance_data, metadata_smoking$`#SampleID`)
abundance_data_smoking$pathway = abundance_data$pathway
abundance_data_smoking <- abundance_data_smoking %>% select(pathway, everything())
abundance_data_nonsmoking <- select(abundance_data, metadata_nonsmoking$`#SampleID`)
abundance_data_nonsmoking$pathway = abundance_data$pathway
abundance_data_nonsmoking <- abundance_data_nonsmoking %>% select(pathway, everything())
# Perform pathway differential abundance analysis (DAA) using LinDA
daa_results_df <- pathway_daa(abundance = abundance_data %>% column_to_rownames("pathway"), metadata = metadata,
group = "smoker", daa_method = "LinDA", select = NULL, reference = NULL)
View(abundance_data)
View(daa_results_df)
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df, ko_to_kegg = TRUE)
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df_smoking, ko_to_kegg = TRUE)
daa_results_df_smoking <- pathway_daa(abundance = abundance_data_smoking%>% column_to_rownames("pathway"), metadata = metadata_smoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
daa_results_df_nonsmoking <- pathway_daa(abundance = abundance_data_nonsmoking %>% column_to_rownames("pathway"), metadata = metadata_nonsmoking,
group = "fibre_category", daa_method = "LinDA", select = NULL, reference = NULL)
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df_smoking, ko_to_kegg = TRUE)
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df_nonsmoking, ko_to_kegg = TRUE)
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df_nonsmoking, ko_to_kegg = FALSE)
View(test)
?pathway_annotation
test <- pathway_annotation(pathway = "KO", daa_results_df = daa_results_df_nonsmoking, ko_to_kegg = TRUE)
View(interesting_nonsmok)
test <- pathway_annotation(pathway = "MetaCyc", daa_results_df = daa_results_df_nonsmoking, ko_to_kegg = FALSE)
View(test)
test <- pathway_annotation(pathway = "MetaCyc", daa_results_df = all_interesting, ko_to_kegg = FALSE)
View(abundance_data)
View(daa_results_df)
all_interesting <- data.frame(feature=c(interesting_nonsmok$pathway,interesting_smok$pathway))
test <- pathway_annotation(pathway = "MetaCyc", daa_results_df = all_interesting, ko_to_kegg = FALSE)
View(all_interesting)
View(test)
all_interesting <- pathway_annotation(pathway = "KO", daa_results_df = all_interesting, ko_to_kegg = FALSE)
View(all_interesting)
MetaCyc
all_interesting <- pathway_annotation(pathway = "MetaCyc", daa_results_df = all_interesting, ko_to_kegg = FALSE)
View(all_interesting)
View(interesting_nonsmok)
View(abundance_data_smoking)
View(abundance_data_nonsmoking)
View(abundance_data_smoking)
View(abundance_data_nonsmoking)
row_sds_nonsmok
View(row_sds_nonsmok)
View(row_sds_smok)
View(abundance_data_smoking)
View(row_sds_nonsmok)
View(abundance_data_smoking[PWY-3801,])
View(abundance_data_smoking[abundance_data_smoking$pathway==PWY-3801,])
View(abundance_data_smoking[abundance_data_smoking$pathway=="PWY-3801",])
(abundance_data_smoking[abundance_data_smoking$pathway=="PWY-3801",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-3801",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-5529",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-5531",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6338",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6339",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6404",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6565",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6581",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6713",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6944",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6948",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6957",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-6992",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-7084",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-7097",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-7098",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-7159",])
(abundance_data_nonsmoking[abundance_data_nonsmoking$pathway=="PWY-7644",])
