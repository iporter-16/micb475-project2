# Load packages
load(vegan)
# Load packages
load(phyloseq)
# Load packages
library(phyloseq)
# Load packages
library(vegan)
library(tidyverse)
load("C:/Users/saman/Desktop/micb475-project2/phyloseq_object_final.RData")
# Load phyloseq object
load(phyloseq_object_final)
# Load phyloseq object
load("phyloseq_object_final.RData:)
# Load phyloseq object
load("phyloseq_object_final.RData")
library(phyloseq)
library(tidyverse)
# Load phyloseq object
load("phyloseq_object_final.RData")
load("colombia_filt_nolow_samps.RData")
# Bray-Curtis
dist_bc <- as.matrix(vegdist(phyloseq_object_final, method = "bray"))
bc_dm <- distance(phyloseq_object_final, method="bray")
# check which methods you can specify
?distance
pcoa_bc <- ordinate(phyloseq_object_final, method="PCoA", distance=bc_dm)
View(pcoa_bc)
View(colombia_filt_nolow_samps)
View(colombia_filt_nolow_samps)
plot_ordination(phyloseq_object_final, pcoa_bc, color = "smoker", shape="fibre_category")
gg_pcoa <- plot_ordination(mpt_rare, pcoa_bc, color = "smoker", shape="fibre_category") +
labs(pch="fibre level", col = "smoking status")
gg_pcoa
gg_pcoa <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "smoker", shape="fibre_category") +
labs(pch="fibre level", col = "smoking status")
gg_pcoa
gg_pcoa_LDL <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "smoker", shape="LDL_category") +
labs(pch="LDL level", col = "smoking status")
gg_pcoa_LDL
gg_pcoa_fibre <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "smoker", shape="fibre_category") +
labs(pch="fibre level", col = "smoking status")
gg_pcoa_fibre
gg_pcoa_LDL
gg_pcoa_fibre
gg_pcoa_LDL
gg_pcoa_fibre
gg_pcoa_LDL
gg_pcoa_fibre
gg_pcoa_LDL
gg_pcoa_fibre
gg_pcoa_LDL
# Save plots
ggsave("plot_pcoa_fibre.png"
, gg_pcoa_fibre
, height=4, width=5)
ggsave("plot_pcoa_LDL.png"
, gg_pcoa_LDL
, height=4, width=5)
plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker")
plot_ordination(phyloseq_object_final, pcoa_bc, color = "LDL_category", shape="smoker")
plot_ordination(phyloseq_object_final, pcoa_bc, color = "LDL_category", shape="smoker")
plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker")
plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker")
plot_ordination(phyloseq_object_final, pcoa_bc, color = "LDL_category", shape="smoker")
gg_pcoa_fibre <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker") +
labs(pch="smoking status", col = "fibre level")
gg_pcoa_fibre
plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker")
gg_pcoa_fibre <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "fibre_category", shape="smoker") +
labs(pch="smoking status", col = "fibre level")
gg_pcoa_fibre
gg_pcoa_LDL <- plot_ordination(phyloseq_object_final, pcoa_bc, color = "LDL_category", shape="smoker") +
labs(pch="smoking status", col = "LDL level")
gg_pcoa_LDL
# Save plots
ggsave("plot_pcoa_fibre.png"
, gg_pcoa_fibre
, height=4, width=5)
ggsave("plot_pcoa_LDL.png"
, gg_pcoa_LDL
, height=4, width=5)
